var AccessSlide=function(){"use strict";var i,a,f={Screen:{id:"screen"},Banner:{id:"banner"},NavBar:{id:"navbar"},WrapperNav:{id:"wrappernav"},Wrapper:{id:"wrapper",classSettingLeft:"Cagauche"},Flap:{id:"volet"},Slide:{classSetting:"slide"},Summary:{id:"sommaire",classSettingFixed:"fixed tool-block tool-block-summary",Ctitle:"Ct"},Setting:{id:"setting",Ctitle:"Ctitle"},FormConfig:{id:"FormConfig"},ConfigButton:{id:"configbutton",classSetting:"btn-group-settings"},LinearIndexTag:{classSetting:"index"},LiveSlideTitle:{id:"Dcourante"},Eno:{val:"Eno",flap:!1,slide:!1,group:"Geffects"},Efadin:{val:"Efadin",classSetting:"fadein",flap:!1,slide:!0,group:"Geffects"},Eleft:{val:"Eleft",classSetting:"ALTR",flap:!0,slide:!1,group:"Geffects"},Eright:{val:"Eright",classSetting:"ARTL",flap:!0,slide:!1,group:"Geffects"},Ebottom:{val:"Ebottom",classSetting:"ATtoT",flap:!0,slide:!1,group:"Geffects"},Etop:{val:"Etop",classSetting:"ATtoB",flap:!0,slide:!1,group:"Geffects"},Flash:{val:"Flash",classSetting:"Flash",flap:!0,slide:!1,group:"Geffects"},Escale:{val:"Escale",classSetting:"Escale",flap:!1,slide:!0,group:"Geffects"},Flip:{val:"Flip",classSetting:"Flip",flap:!1,slide:!0,group:"Geffects"},ffoodd:{val:"ffoodd",classSetting:"ffoodd",flap:!1,slide:!1,group:"Geffects"},Stexte:{id:"Stexte",file:"bip_texte_masque"},Sdiapo:{id:"Sdiapo",file:"bip_diapo_on"},Sdiapo1:{id:"Sdiapo1",file:"bip_diapo1_on"},Sdiapoend:{id:"Sdiapoend",file:"bip_diapo_end"},Caudio:{id:"Caudio"},HiddenContent:{classSetting:"Cmasque"},VocalizeNdiapo:{id:"VocalizeNdiapo",classSetting:"input-setting",classHelpSetting:"help",classLabelSetting:"label-setting setting-sound",IconSrc:"../accesslide/img/sound.svg?2",val:0,group:"Gaccess"},SoundTxt:{id:"SoundTxt",classSetting:"input-setting",classHelpSetting:"help",classLabelSetting:"label-setting setting-sound",IconSrc:"../accesslide/img/sound.svg?2",val:0,group:"Gaccess"},SoundSlide:{id:"SoundSlide",classSetting:"input-setting",classHelpSetting:"help",classLabelSetting:"label-setting setting-sound",IconSrc:"../accesslide/img/sound.svg?2",val:0,group:"Gaccess"},SoundSlide1:{id:"SoundSlide1",classSetting:"input-setting",classHelpSetting:"help",classLabelSetting:"label-setting setting-sound",IconSrc:"../accesslide/img/sound.svg?2",val:0,group:"Gaccess"},SoundSlideEnd:{id:"SoundSlideEnd",classSetting:"input-setting",classHelpSetting:"help",classLabelSetting:"label-setting setting-sound",IconSrc:"../accesslide/img/sound.svg?2",val:0,group:"Gaccess"},VocalizeTitle:{id:"VocalizeTitle",classSetting:"input-setting",classHelpSetting:"help",classLabelSetting:"label-setting setting-sound",IconSrc:"../accesslide/img/sound.svg?2",val:0,group:"Gaccess"},UpWindowTitle:{id:"UpWindowTitle",classSetting:"input-setting",classHelpSetting:"help",classLabelSetting:"label-setting setting-sound",IconSrc:"../accesslide/img/sound.svg?2",val:0,group:"Gaccess"},GotoBnext:{id:"GotoBnext",classSetting:"input-setting",classHelpSetting:"help",classLabelSetting:"label-setting setting-next",IconSrc:"../accesslide/img/next.svg?2",val:0,group:"Gaccess"},Noclick:{id:"Noclick",classSetting:"input-setting",classHelpSetting:"help",classLabelSetting:"label-setting setting-mouse",IconSrc:"../accesslide/img/click.svg?2",val:1,group:"Gaccess"},SumModOn:{id:"SumModOn",classSetting:"input-setting",classHelpSetting:"help",classLabelSetting:"label-setting setting-summary",IconSrc:"../accesslide/img/summary.svg?2",val:1,group:"Gslide"},ModePlan:{id:"ModePlan",classSetting:"input-setting",classHelpSetting:"help",classLabelSetting:"label-setting setting-plan",IconSrc:"../accesslide/img/plan.svg?2",val:0,group:"Gslide"},Bsubmit:{id:"setconfig",classSetting:"btn-setting"},Bdefault:{id:"resetconfig",classSetting:"btn-setting"},Bclose:{idSummary:"close",idConfig:"Close2",classSetting:"btn-close",iconClass:"icon icon-close",fallbackClass:"text",fallBackSrcImg:"../accesslide/img/close.svg?2"},Bprev:{id:"prev",classSetting:"tool-bar-elt btn btn-prev",iconClass:"icon icon-prev",fallbackClass:"text",fallBackSrcImg:"../accesslide/img/prev.svg?2"},Bnext:{id:"next",classSetting:"tool-bar-elt btn btn-next",iconClass:"icon icon-next",fallbackClass:"text",fallBackSrcImg:"../accesslide/img/next.svg?2"},Select:{id:"tocP",classSetting:"select-goto"},Bselect:{id:"tocp",classSetting:"btn btn-goto",iconClass:"icon icon-goto",fallbackClass:"text",fallBackSrcImg:"../accesslide/img/goto.svg?2"},Btoc:{id:"toc",classSetting:"tool-bar-elt btn btn-block-summary",iconClass:"icon icon-summary",fallbackClass:"text",fallBackSrcImg:"../accesslide/img/summary.svg?2"},Bconfig:{id:"set",classSetting:"tool-bar-elt btn btn-block-settings",iconClass:"icon icon-settings",fallbackClass:"text",fallBackSrcImg:"../accesslide/img/settings.svg?2"},SelectWrapper:{id:"Fgo",classSetting:"tool-bar-elt"},TocSelect:{id:"tocP"},SlideCounter:{id:"cpt",idCurrent:"current",idTotal:"total",classSetting:"tool-bar-elt slide-counter",currentClass:"tool-bar-elt slide-counter-current",isHiddenClass:"sr",totalClass:"tool-bar-elt slide-counter-total"},IconFallBack:{classSetting:"icon-fallback-text"},Ctitle:{classSetting:"tool-block-title"}},d=0,o=[],s=[],e=0,c=0,t=new Array("BUTTON","A","SELECT","INPUT","AUDIO","VIDEO","TEXTAREA","LABEL"),l=null,n=document.title,r=["webkit","moz","MS","o",""];function u(){for(var e=k(f.Screen.id).getAttribute("data-effect"),t=0,i=o.length;t<i;t++)o[t].style.display="none",o[t].classList.remove(f[e].classSetting);k(f.Flap.id).classList.remove(f[e].classSetting)}function p(){0===c?((d+=1)>=o.length&&(d-=1),u(),o[d]&&(o[d].style.display="block"),B(),0===d||d===o.length-1?k(f.Banner.id).style.top="-100000px":k(f.Banner.id).style.top="4px",y(),k(f.SlideCounter.idCurrent).firstChild.nodeValue=d+1,E(),1===f.VocalizeTitle.val&&N(),v()):(s[e]&&(s[e].style.visibility="visible"),1===f.SoundTxt.val&&k(f.Stexte.id).play(),(e+=1)>=s.length&&(e=c=0,s.length=0))}function g(){0===c?((d-=1)<0&&(d=0),u(),o[d]&&(o[d].style.display="block"),B(),0===d||d===o.length-1?k(f.Banner.id).style.top="-1000000px":k(f.Banner.id).style.top="4px",y(),k(f.SlideCounter.idCurrent).firstChild.nodeValue=d+1,E(),1==f.VocalizeTitle.val&&N(),v(1)):(s[e].style.visibility="hidden",1===f.SoundTxt.val&&k(f.Stexte.id).play(),(e+=1)>=s.length&&(e=c=0,s.length=0))}function m(){0===c||1===i?(d>=o.length&&(d=0),u(),o[d]&&(o[d].style.display="block"),B(),0===d||d===o.length-1?k(f.Banner.id).style.top="-100000px":k(f.Banner.id).style.top="4px",y(),k(f.SlideCounter.idCurrent).firstChild.nodeValue=d+1,E(),1===f.VocalizeTitle.val&&N(),v(),i=null):(s[e].style.visibility="visible",1===f.SoundTxt.val&&k(f.Stexte.id).play(),(e+=1)>=s.length&&(e=c=0,s.length=0))}function S(){-1<parseInt(k(f.TocSelect.id).value)?(d=parseInt(k(f.TocSelect.id).value),m(),i=1):k(f.TocSelect.id).focus()}function b(){var e=this.getAttribute("data-slide");if(d=parseInt(e),1===f.SumModOn.val&&A(),0===f.ModePlan.val)m();else{var t=a+"#D"+e;window.location.href=t}i=1}function v(e){for(var t=o[d].querySelectorAll("*"),i=0,l=0,n=t.length;l<n;l++)t[l].classList.contains(f.HiddenContent.classSetting)&&(s[i]=t[l],i++);if(0<s.length){c=1;for(l=0,n=s.length;l<n;l++)s[l].style.visibility=1===e?"visible":"hidden";1===e&&s.reverse()}}function h(){1===f.SumModOn.val?(k(f.Summary.id).setAttribute("role","dialog"),k(f.Summary.id).setAttribute("aria-labelledby",f.Summary.Ctitle)):0===f.ModePlan.val?(k(f.Wrapper.id).style.width="75%",k(f.Wrapper.id).style.fontSize="80%"):k(f.Wrapper.id).setAttribute("class",f.Wrapper.classSettingLeft),k(f.Summary.id).style.display="block",k(f.Bclose.idSummary).focus(),l=k(f.Summary.id),E()}function C(){k(f.Setting.id).style.display="block",k(f.Bclose.idConfig).focus(),l=k(f.Setting.id)}function A(){switch(l.getAttribute("id")){case"sommaire":k(f.Wrapper.id).removeAttribute("style"),k(f.Summary.id).style.display="none",k(f.Btoc.id).focus();break;case"setting":k(f.Setting.id).style.display="none",k(f.Bconfig.id).focus()}1===f.ModePlan.val&&k(f.Wrapper.id).removeAttribute("class"),l=null}function E(){0===f.ModePlan.val?0<d&&d+1<o.length?(k(f.Summary.id).style.top="10%",k(f.Summary.id).style.height="85%"):(k(f.Summary.id).style.top="0",k(f.Summary.id).style.height="95%"):(k(f.Summary.id).style.top="0",k(f.Summary.id).setAttribute("class",f.Summary.classSettingFixed))}function y(){var e=k(f.Screen.id).getAttribute("data-effect");f[e].flap?k(f.Flap.id).classList.add(f[e].classSetting):f[e].slide&&o[d].classList.add(f[e].classSetting),o[d].style.opacity="1"}function B(){1===f.SoundSlide.val&&0!=d&&k(f.Sdiapo.id).play(),1===f.SoundSlide1.val&&0===d&&k(f.Sdiapo1.id).play(),1===f.SoundSlideEnd.val&&d===o.length-1&&k(f.Sdiapoend.id).play(),1===f.UpWindowTitle.val&&x()}function T(e,t){var i=document.createElement("AUDIO");i.setAttribute("id",t);var l=document.createElement("SOURCE");l.setAttribute("src","sound/"+e+".mp3"),l.setAttribute("type","audio/mp3");var n=document.createElement("SOURCE");n.setAttribute("src","sound/"+e+".ogg"),n.setAttribute("type","audio/ogg"),i.appendChild(l),i.appendChild(n),k(f.Caudio.id).appendChild(i)}function N(){var e=o[d].childNodes;if(k(f.LiveSlideTitle.id).innerHTML="","H2"===e[1].tagName)k(f.LiveSlideTitle.id).innerHTML=e[1].innerHTML;else{var t=document.createTextNode(o[d].getAttribute("aria-label"));k(f.LiveSlideTitle.id).appendChild(t)}}function x(){document.title="";var e=o[d].childNodes;if("H2"===e[1].tagName)var t=e[1].innerText||e[1].textContent;else t=o[d].getAttribute("aria-label");document.title=t+" | "+n}function I(){for(var e=document.querySelectorAll("#setting fieldset input, #setting fieldset select"),t=0,i=e.length;t<i;t++){var l,n=e[t].getAttribute("id");"INPUT"===e[t].nodeName&&(l=e[t].checked?1:0,f[n].val=l),"SELECT"===e[t].nodeName&&(l=e[t].value);try{localStorage.setItem(n,l)}catch(e){O(n,l,0)}}}function L(){for(var e=document.querySelectorAll("#setting fieldset input, #setting fieldset select"),t=0,i=e.length;t<i;t++){var l=e[t].getAttribute("id");try{localStorage.removeItem(l)}catch(e){P(l)}"INPUT"===e[t].nodeName?1===f[l].val&&e[t].setAttribute("checked","checked"):"SELECT"===e[t].nodeName&&(e[t].value=f.ffoodd.val)}}function k(e,t){var i,l;return i=t||0,document.getElementById(e)&&(l=document.getElementById(e)),document.getElementsByClassName(e)[i]&&(l=document.getElementsByClassName(e)[i]),document.getElementsByTagName(e)[i]&&(l=document.getElementsByTagName(e)[i]),l}function G(e){var t;if(-1<[9,13,27,32,33,34,35,36,37,38,39,40,48].indexOf(e.keyCode))return t=e.keyCode,e.altKey?t="2"+e.keyCode:e.shiftKey&&(t="1"+e.keyCode),t}function O(e,t,i){if(i){var l=new Date;l.setTime(l.getTime()+24*i*60*60*1e3);var n="; expires="+l.toGMTString()}else n="";document.cookie=e+"="+t+n+"; path=/"}function w(e){for(var t=e+"=",i=document.cookie.split(";"),l=0;l<i.length;l++){for(var n=i[l];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null}function P(e){O(e,"",-1)}window.onload=function(){!function(){var e=document.createElement("H1");e.appendChild(document.createTextNode(lang.ConfigTitle)),e.setAttribute("id",f.Setting.Ctitle),e.setAttribute("class",f.Ctitle.classSetting),k(f.Setting.id).setAttribute("aria-labelledby",f.Setting.Ctitle);var t=document.createElement("BUTTON");t.setAttribute("type","button"),t.setAttribute("id",f.Bclose.idConfig),t.className=f.Bclose.classSetting;var i=document.createElement("IMG");i.src=f.Bclose.fallBackSrcImg,i.setAttribute("alt",lang.Wclose),i.setAttribute("role","img"),i.setAttribute("height","16"),i.setAttribute("width","16"),t.appendChild(i),e.appendChild(t),k(f.Setting.id).appendChild(e);var l=document.createElement("FORM");l.setAttribute("id",f.FormConfig.id),l.setAttribute("action","");var n=document.createElement("FIELDSET");(d=document.createElement("LEGEND")).appendChild(document.createTextNode(lang.Gaccess.legend)),n.appendChild(d);var a=document.createElement("FIELDSET");(d=document.createElement("LEGEND")).appendChild(document.createTextNode(lang.Gslide.legend)),a.appendChild(d);var d,s=document.createElement("FIELDSET");(d=document.createElement("LEGEND")).appendChild(document.createTextNode(lang.Geffects.legend)),s.appendChild(d);var c=document.createElement("SELECT");c.setAttribute("id","Effects");var r=document.createElement("label");for(var o in r.setAttribute("for","Effects"),r.appendChild(document.createTextNode(lang.LabelEffect)),s.appendChild(r),s.appendChild(document.createElement("BR")),s.appendChild(c),s.appendChild(document.createElement("BR")),f)switch(f[o].group){case"Gaccess":var u=document.createElement("INPUT");u.setAttribute("id",f[o].id),u.setAttribute("aria-describedby","help-"+f[o].id),u.setAttribute("type","checkbox"),u.className=f[o].classSetting;var r=document.createElement("LABEL");r.setAttribute("for",f[o].id),r.className=f[o].classLabelSetting;var p=document.createElement("IMG");p.setAttribute("aria-hidden","true"),p.setAttribute("width","12"),p.setAttribute("height","12"),p.setAttribute("alt",""),p.src=f[o].IconSrc,r.appendChild(p),r.appendChild(document.createTextNode(lang[o].label));var g=document.createElement("P");g.setAttribute("id","help-"+f[o].id),g.setAttribute("class",f[o].classHelpSetting),g.appendChild(document.createTextNode(lang[o].help)),n.appendChild(u),n.appendChild(g),n.appendChild(r),n.appendChild(document.createElement("BR"));break;case"Gslide":var u=document.createElement("INPUT");u.setAttribute("id",f[o].id),u.setAttribute("aria-describedby","help-"+f[o].id),u.setAttribute("type","checkbox"),u.className=f[o].classSetting;var r=document.createElement("LABEL");r.setAttribute("for",f[o].id),r.className=f[o].classLabelSetting;var p=document.createElement("IMG");p.setAttribute("aria-hidden","true"),p.setAttribute("width","12"),p.setAttribute("height","12"),p.setAttribute("alt",""),p.src=f[o].IconSrc,r.appendChild(p),r.appendChild(document.createTextNode(lang[o].label));var g=document.createElement("P");g.setAttribute("id","help-"+f[o].id),g.setAttribute("class",f[o].classHelpSetting),g.appendChild(document.createTextNode(lang[o].help)),a.appendChild(u),a.appendChild(g),a.appendChild(r),a.appendChild(document.createElement("BR"));break;case"Geffects":var m=document.createElement("OPTION");m.setAttribute("value",f[o].val),m.appendChild(document.createTextNode(lang[o].help)),c.appendChild(m)}l.appendChild(n),l.appendChild(a),l.appendChild(s);var S,b=document.createElement("DIV");b.setAttribute("id",f.ConfigButton.id),b.setAttribute("class",f.ConfigButton.classSetting),(S=document.createElement("INPUT")).setAttribute("id",f.Bsubmit.id),S.setAttribute("class",f.Bsubmit.classSetting),S.setAttribute("type","submit"),S.setAttribute("title",lang.Bsubmit.title),S.setAttribute("value",lang.Bsubmit.value),b.appendChild(S),(S=document.createElement("INPUT")).setAttribute("id",f.Bdefault.id),S.setAttribute("class",f.Bdefault.classSetting),S.setAttribute("type","submit"),S.setAttribute("title",lang.Bdefault.title),S.setAttribute("value",lang.Bdefault.value),b.appendChild(S),l.appendChild(b),k(f.Setting.id).appendChild(l)}(),function(){var e=window.location.href;a=0<e.indexOf("#")?a=e.slice(0,e.indexOf("#")):e,k(f.FormConfig.id).setAttribute("action",a);for(var t=document.querySelectorAll("#setting fieldset input, #setting fieldset select"),i=0;i<t.length;i++){var l=t[i].getAttribute("id");try{var n=localStorage.getItem(l)}catch(e){var n=w(l)}n&&("INPUT"===t[i].nodeName?(1===parseInt(n)&&t[i].setAttribute("checked","checked"),f[l].val=parseInt(n)):"SELECT"===t[i].nodeName&&k(f.Screen.id).setAttribute("data-effect",n)),"INPUT"===t[i].nodeName?0<f[l].val&&t[i].setAttribute("checked","checked"):"SELECT"===t[i].nodeName&&(t[i].value=n)}}(),function(){var e=document.createElement("UL");e.setAttribute("id",f.NavBar.id);var t=document.createElement("LI");(a=document.createElement("BUTTON")).setAttribute("type","button"),a.setAttribute("id",f.Bprev.id),a.setAttribute("title",lang.Bprev.title),a.className=f.Bprev.classSetting,(d=document.createElement("IMG")).src=f.Bprev.fallBackSrcImg,d.setAttribute("alt",lang.Bprev.title),d.setAttribute("role","img"),d.setAttribute("height","32"),d.setAttribute("width","32"),a.appendChild(d),t.appendChild(a),e.appendChild(t);var t=document.createElement("LI");(n=document.createElement("DIV")).setAttribute("id",f.SelectWrapper.id),n.className=f.SelectWrapper.classSetting;var i=document.createElement("SELECT");i.setAttribute("id",f.Select.id),i.setAttribute("title",lang.Select.title),i.className=f.Select.classSetting,n.appendChild(i),(a=document.createElement("BUTTON")).setAttribute("type","button"),a.setAttribute("id",f.Bselect.id),a.setAttribute("title",lang.Bselect.title),a.className=f.Bselect.classSetting,(d=document.createElement("IMG")).src=f.Bselect.fallBackSrcImg,d.setAttribute("alt",lang.Bselect.title),d.setAttribute("role","img"),d.setAttribute("height","32"),d.setAttribute("width","32"),a.appendChild(d),n.appendChild(a),t.appendChild(n),e.appendChild(t);var t=document.createElement("LI");(a=document.createElement("BUTTON")).setAttribute("type","button"),a.setAttribute("id",f.Bnext.id),a.setAttribute("title",lang.Bnext.title),a.className=f.Bnext.classSetting,(d=document.createElement("IMG")).src=f.Bnext.fallBackSrcImg,d.setAttribute("alt",lang.Bnext.title),d.setAttribute("role","img"),d.setAttribute("height","32"),d.setAttribute("width","32"),a.appendChild(d),t.appendChild(a),e.appendChild(t);var t=document.createElement("LI");(a=document.createElement("BUTTON")).setAttribute("type","button"),a.setAttribute("id",f.Btoc.id),a.setAttribute("title",lang.Btoc.title),a.className=f.Btoc.classSetting,(d=document.createElement("IMG")).src=f.Btoc.fallBackSrcImg,d.setAttribute("alt",lang.Btoc.title),d.setAttribute("role","img"),d.setAttribute("height","32"),d.setAttribute("width","32"),a.appendChild(d),t.appendChild(a),e.appendChild(t),(t=document.createElement("LI")).setAttribute("id",f.SlideCounter.id),t.className=f.SlideCounter.classSetting;var l,n=document.createElement("DIV");(l=document.createElement("SPAN")).appendChild(document.createTextNode("1")),l.setAttribute("id",f.SlideCounter.idCurrent),l.className=f.SlideCounter.currentClass,n.appendChild(l),(l=document.createElement("SPAN")).appendChild(document.createTextNode(lang.Ndxon)),l.className=f.SlideCounter.isHiddenClass,n.appendChild(l),(l=document.createElement("SPAN")).setAttribute("id",f.SlideCounter.idTotal),l.appendChild(document.createTextNode("999")),l.className=f.SlideCounter.totalClass,n.appendChild(l),t.appendChild(n),e.appendChild(t);var a,d,t=document.createElement("LI");(a=document.createElement("BUTTON")).setAttribute("type","button"),a.setAttribute("id",f.Bconfig.id),a.setAttribute("title",lang.Bconfig.title),a.className=f.Bconfig.classSetting,(d=document.createElement("IMG")).src=f.Bconfig.fallBackSrcImg,d.setAttribute("alt",lang.Bconfig.title),d.setAttribute("role","img"),d.setAttribute("height","32"),d.setAttribute("width","32"),a.appendChild(d),t.appendChild(a),e.appendChild(t),k(f.WrapperNav.id).appendChild(e)}(),1===f.VocalizeNdiapo.val&&k(f.SlideCounter.id).setAttribute("aria-live","polite"),1===f.VocalizeNdiapo.val&&k(f.SlideCounter.id).setAttribute("aria-atomic","false"),1===f.GotoBnext.val&&k(f.Bnext.id).focus(),1===f.SoundTxt.val&&T(f.Stexte.file,f.Stexte.id),1===f.SoundSlide.val&&T(f.Sdiapo.file,f.Sdiapo.id),1===f.SoundSlide1.val&&T(f.Sdiapo1.file,f.Sdiapo1.id),1===f.SoundSlideEnd.val&&T(f.Sdiapoend.file,f.Sdiapoend.id),function(){try{d=parseInt(sessionStorage.Scurrent),sessionStorage.clear()}catch(e){d=parseInt(w("Scurrent")),P("Scurrent")}d||(d=0);o=document.getElementsByClassName(f.Slide.classSetting),0===f.ModePlan.val&&u();k(f.SlideCounter.idCurrent).firstChild.nodeValue=d+1,1===f.VocalizeTitle.val&&N();k(f.SlideCounter.idTotal).firstChild.nodeValue=o.length,o[d].style.display="block",1===f.SoundSlide1.val&&0===d&&k(f.Sdiapo1.id).play();1===f.UpWindowTitle.val&&x();0===f.ModePlan.val?(document.body.style.height="98.5%",k(f.Screen.id).classList.remove("modeplan"),0!==d&&d!==o.length-1||(k(f.Banner.id).style.top="-10000px"),y()):(k(f.Screen.id).classList.add("modeplan"),k(f.Screen.id).setAttribute("data-effect","noEffect"),function(){for(var e=0,t=o.length;e<t;e++){var i=document.createElement("P"),l=document.createElement("SPAN"),n=document.createTextNode(e+1+" / "+t);l.appendChild(n),i.appendChild(l),i.setAttribute("class",f.LinearIndexTag.classSetting),o[e].setAttribute("id","D"+e),o[e].appendChild(i)}}());!function(){var e,t={},i=document.createElement("H1");i.setAttribute("id",f.Summary.Ctitle),i.appendChild(document.createTextNode(lang.SummaryTitle));var l=document.createElement("BUTTON");l.setAttribute("type","button"),l.setAttribute("id",f.Bclose.idSummary),i.setAttribute("class",f.Ctitle.classSetting),l.className=f.Bclose.classSetting;var n=document.createElement("IMG");n.src=f.Bclose.fallBackSrcImg,n.setAttribute("alt",lang.Wclose),n.setAttribute("role","img"),n.setAttribute("height","16"),n.setAttribute("width","16"),l.appendChild(n),i.appendChild(l),k(f.Summary.id).appendChild(i);for(var a=0;a<o.length;a++)e=o[a].querySelector("h2"),t[a]=e?e.innerText||e.textContent:o[a].getAttribute("aria-label");var d=document.createElement("OL");for(var a in t){var s=document.createElement("LI"),c=document.createElement("BUTTON");c.setAttribute("type","button"),c.setAttribute("data-slide",a),c.addEventListener("click",b,!1);var r=document.createTextNode(t[a]);c.appendChild(r),s.appendChild(c),d.appendChild(s)}k(f.Summary.id).appendChild(d)}()}(),function(){var e=document.createElement("OPTION"),t=document.createTextNode("-");e.setAttribute("value",""),e.appendChild(t),document.getElementById(f.TocSelect.id).appendChild(e);for(var i=0,l=o.length;i<l;i++){var e=document.createElement("OPTION"),n=i,t=document.createTextNode(n+1);e.setAttribute("value",n),e.appendChild(t),document.getElementById(f.TocSelect.id).appendChild(e)}}(),0===f.ModePlan.val&&0===f.Noclick.val&&document.addEventListener("click",function(e){t.indexOf(document.activeElement.tagName)<0&&p()},!0),document.addEventListener("keydown",function(e){248==G(e)&&h(),0===f.ModePlan.val&&(32===G(e)&&(p(),e.preventDefault()),39!==G(e)&&34!==G(e)||(p(),e.preventDefault()),37!==G(e)&&33!==G(e)&&132!=G(e)||(g(),e.preventDefault()),36===G(e)&&(d=0,m(),e.preventDefault()),35===G(e)&&(d=o.length-1,m(),e.preventDefault()),13===G(e)&&t.indexOf(document.activeElement.tagName)<0&&(p(),e.preventDefault()))},!1),k(f.Bnext.id).addEventListener("click",p,!1),k(f.Bprev.id).addEventListener("click",g,!1),k(f.Btoc.id).addEventListener("click",h,!1),k(f.Bclose.idSummary).addEventListener("click",A,!1),k(f.Select.id).addEventListener("change",function(){k(f.Bselect.id).removeAttribute("disabled","disabled")},!1),k(f.Bselect.id).addEventListener("blur",function(){k(f.Select.id).value="",k(f.Bselect.id).setAttribute("disabled","disabled")},!1),k(f.Bselect.id).addEventListener("click",S,!1),k(f.Bconfig.id).addEventListener("click",C,!1),k(f.Bclose.idConfig).addEventListener("click",A,!1),k(f.Bsubmit.id).addEventListener("click",I,!1),k(f.Bdefault.id).addEventListener("click",L,!1),f.SumModOn.val,document.addEventListener("focus",function(e){l&&!l.contains(e.target)&&(e.stopPropagation(),l.focus())},!0),document.addEventListener("keydown",function(e){l&&27==G(e)&&(A(),l=null)},!0),function(e,t,i){for(var l=0;l<r.length;l++)r[l]||(t=t.toLowerCase()),e.addEventListener(r[l]+t,i,!1)}(k(f.Flap.id),"AnimationEnd",function(){k(f.Flap.id).removeAttribute("class")}),window.onbeforeunload=function(){try{sessionStorage.setItem("Scurrent",d)}catch(e){O("Scurrent",d,0)}}}}();